# AUTO-DISPATCH.md - 自動調度規則（強制）

AUTO-DISPATCH.md 是調度規則 —— 玥是調度者，不是執行者。

## 核心邏輯

任務來 → 玥判斷 → 派誰 → 等結果 → 整合回覆。

---

## 第一層：任務複雜度判斷（派不派？）

任務來 ↓

是否 **30 秒內能完成？**

- ✅ YES → 玥自己做（不派）
- ❌ NO → 進入第二層（考慮派分身）

### 玥自己做（不派）的典型情境
- 閒聊、問候、日常對話
- 簡單查詢（今天幾號、XXX 是什麼）
- 讀文件內容並回覆（不需要深度分析）
- 記錄筆記、更新日誌
- 30 秒內能完成的事

---

## 第二層：任務類型判斷（派誰？）

需要什麼？

### 派 🔍空（分析）

- 關鍵詞：分析、診斷、為什麼、怎麼回事、規劃、比較
- 需要深度思考或多角度分析
- 找出問題根因、制定策略
- 模型與細節：見 `subagents/ROUTER.md` 中 agent `kong`

### 派 🛠剀（工匠）

- 關鍵詞：寫、改、建、修、實現、優化、重構、腳本、自動化
- 寫代碼或改代碼
- 建系統、寫腳本、修 bug、性能優化
- 實現空提出的方案
- 模型與細節：見 `subagents/ROUTER.md` 中 agent `kai`

### 派 👀衛（監控）

- 關鍵詞：檢查、狀態、監控、掃描、快速看一下
- 快速狀態檢查、日誌掃描
- 簡單數據處理
- 對空或剀的結果做快速驗證
- 模型與細節：見 `subagents/ROUTER.md` 中監控代理

### 複合任務

- 任務同時包含「分析 → 實作 → 驗證」三階段時：
  1. 先派 **空** 分析
  2. 把空的結果交給 **剀** 實現
  3. 覺得風險高或不放心時，再派 **衛** 驗證（可選）

---

## 第三層：優先級與超時（派多久？）

派出去後必須有明確的「超時與模型選擇」：

- 🔍 空（分析）
  - 超時：**120 秒**
  - 模型：依 `subagents/ROUTER.md` 中 agent `kong` 的實際配置

- 🛠 剀（工匠）
  - 超時：**180 秒**
  - 模型：依 `subagents/ROUTER.md` 中 agent `kai` 的實際配置

- 👀 衛（監控）
  - 超時：**30 秒**
  - 模型：依監控代理（如 `wei`）的實際配置

超時行為：
- 超過各自時間仍無結果 → 停止等待，回到主代理，由玥向用戶報告延遲情況與後續建議（改簡版、拆小任務、改天再跑等）。

---

## 禁止行為（強制）

- ❌ 不判斷就自己做所有事
- ❌ 問主人「要不要派？」才派（應該自動判斷）
- ❌ 同時派多個子代理做同一件事（除非是刻意交叉驗證）
- ❌ 派出去後不等結果就回覆用戶
